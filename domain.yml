version: "3.1"

intents:
  - saludo
  - solicitar_cita
  - cancelar_cita
  - reprogramar_cita
  - consultar_cita_activa
  - consultar_servicios
  - consultar_horarios_disponibles
  - confirmar
  - negar
  - seleccionar_servicio
  - informar_fecha
  - informar_hora
  - consulta_mecanica
  - agradecer
  - despedirse
  - faq_duracion_servicios
  - consultar_historial_citas

entities:
  - servicio
  - fecha
  - hora

slots:
  servicio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: servicio
      - type: from_text
        intent: seleccionar_servicio
  fecha:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: fecha
      - type: from_text
        intent: informar_fecha
  hora:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: hora
      - type: from_text
        intent: informar_hora

  horarios_disponibles:
    type: list
    influence_conversation: false
    mappings:
      - type: custom

  tabla_horarios_html:
    type: text
    influence_conversation: false
    initial_value: ""
    mappings:
      - type: custom

responses:
  utter_saludo:
    - text: "¬°Hola! ¬øEn qu√© puedo ayudarte hoy con tu veh√≠culo?"
  utter_despedida:
    - text: "¬°Hasta luego! Que tengas un buen d√≠a."
  utter_agradecimiento:
    - text: "¬°De nada! Estoy aqu√≠ para ayudarte."
  utter_consultar_servicios:
    - text: "Servicios disponibles:\n- Cambio de aceite\n- Revisi√≥n general\n- Alineaci√≥n\n- Balanceo\n- Mantenimiento preventivo\n¬øCu√°l necesitas?"
  utter_ask_servicio:
    - text: "¬øQu√© servicio necesitas? (cambio de aceite, revisi√≥n general, alineaci√≥n, balanceo, mantenimiento preventivo)"
  utter_ask_fecha:
    - text: "¬øPara qu√© fecha deseas la nueva cita? (Formato: AAAA-MM-DD - Ejemplo: 2025-06-15)"
  utter_ask_hora:
    - text: |
        ¬øA qu√© hora deseas la cita? Elige una de las horas disponibles (Ejemplo: 10:00, entre 08:00 y 18:00)
        {tabla_horarios_html}
  utter_confirmar_cita:
    - text: "Resumen de cita:\nServicio: {servicio}\nFecha: {fecha}\nHora: {hora}\n¬øConfirmar?"
  utter_cancelar_cita:
    - text: "‚úÖ Cita cancelada exitosamente"
  utter_resumen_reprogramacion:
    - text: "Nueva fecha/hora propuestas:\nFecha: {fecha}\nHora: {hora}\n¬øConfirmar?"
  utter_reprogramacion_exitosa:
    - text: "‚úÖ Tu cita fue reprogramada a {fecha} a las {hora}."
  utter_no_hay_cita_activa:
    - text: "No encuentro una cita activa para reprogramar. Puedes crear una nueva."
  utter_error_fecha:
    - text: "‚ö†Ô∏è Fecha inv√°lida. Ingresa una fecha igual o futura a la actual(Ej: 2025-05-30)"
  utter_error_hora:
    - text: "‚ö†Ô∏è Hora fuera de nuestro horario (08:00 - 18:00)"
  utter_hora_ocupada:
    - text: "‚ö†Ô∏è Esa hora ya est√° ocupada. Por favor elige otra."
  utter_horarios:
    - text: "Horarios de atenci√≥n:\nLunes a Viernes: 08:00 - 18:00\nS√°bados: 08:00 - 18:00  y \ndomingos cerrado"
  utter_default:
    - text: "ü§ñ No entend√≠. ¬øPodr√≠as repetirlo?"
  utter_duracion_servicios:
    - text: "Duraci√≥n aproximada de servicios:\n- Cambio de aceite: 30 min\n- Alineaci√≥n: 1 hora\n- Revisi√≥n general: 2 horas"

forms:
  agendar_cita_form:
    required_slots:
      - servicio
      - fecha
      - hora

  reprogramar_cita_form:
    required_slots:
      - fecha
      - hora

actions:
  - action_agendar_cita
  - action_cancelar_cita
  - action_reprogramar_cita
  - validate_agendar_cita_form
  - validate_reprogramar_cita_form
  - action_default_fallback
  - action_responder_consulta_mecanica
  - action_consultar_cita
  - action_mostrar_historial
  - action_session_start

session_config:
  session_expiration_time: 7200       # en segundos (2 horas)
  carry_over_slots_to_new_session: true